<div class="px-6 md:px-12 py-10 animate-fadeIn">

  <!-- Breadcrumbs -->
  @if (!loading && breadcrumbs.length > 0) {
  <div class="mb-6">
    <app-breadcrumb [segments]="breadcrumbs"></app-breadcrumb>
  </div>
  }

  <!-- Back Button -->
  <div class="mb-4">
    <app-back-button></app-back-button>
  </div>

  <!-- Title -->
  <h2 class="page-title">
    Select Your Branch
  </h2>

  <!-- Description -->
  <p class="page-description">
    Choose your branch to access organized study materials.
  </p>



  <!-- Loading skeleton -->
  @if (loading) {
  <app-grid-skeleton [count]="6" columns="grid-cols-1 sm:grid-cols-2 lg:grid-cols-3" [lines]="2" [showBadge]="false"
    [showButton]="false"></app-grid-skeleton>
  }



  <!-- Error State -->
  @if (!loading && error) {
  <div class="bg-red-50 border border-red-200 rounded-lg p-6 mb-6" role="alert" aria-live="polite">
    <div class="flex items-start gap-3">
      <svg class="w-6 h-6 text-red-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <div>
        <h3 class="text-lg font-semibold text-red-800 mb-1">Error Loading Branches</h3>
        <p class="text-red-700">{{ error }}</p>
        <button (click)="ngOnInit()" class="mt-4 btn-primary bg-red-600 hover:bg-red-700"
          aria-label="Retry loading branches">
          Retry
        </button>
      </div>
    </div>
  </div>
  }

  <!-- Grid -->

  @if (!loading && !error) {
  @if (branches.length === 0) {
  <app-empty-state icon="academic" title="No Branches Available"
    message="No branches are currently available. Please check back later." [showAction]="false"></app-empty-state>
  } @else {
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6" role="list" aria-label="List of branches">



    @for (b of branches; track b.id) {
    <div (click)="goToBranch(b)" (keydown.enter)="goToBranch(b)" (keydown.space)="goToBranch(b)" tabindex="0"
      role="listitem"
      class="card-hover rounded-xl bg-white p-6 cursor-pointer border border-transparent 
             focus:outline-none focus:ring-2 focus:ring-brand-primary focus:ring-offset-2"
      [attr.aria-label]="'Navigate to ' + b.name + ' branch'">

      <h3 class="section-title">
        {{ b.name }}
      </h3>

      <!-- Show branch code for identification -->
      <p class="text-brand-accent text-sm font-medium mb-2">
        Code: {{ b.code | uppercase }}
      </p>

      <p class="card-text">
        Click to explore materials
      </p>

    </div>
    }



  </div>
  }
  }



</div>